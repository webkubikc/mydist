let getNavigation=function(t){let l,i="none";if("object"==typeof t){let e=document.createNodeIterator(t,NodeFilter.SHOW_COMMENT);for(;l=e.nextNode();)if(8===l.nodeType&&"ENGINE_NAVIGATION"===l.nodeValue&&"ENGINE_NAVIGATION"!==l.nextSibling.nodeValue){i=l.nextSibling;break}}return i},navigation=getNavigation(document.body),filterNavigation="none";$(function(){$("[data-dlefilter*=dle-filter] input, [data-dlefilter*=dle-filter] textarea").keypress(function(e){13==e.which&&(e.preventDefault(),r($(this).closest("form"),!0))});function d(e){dleFilter.id=("FORM"!==e?$(e).closest("form[data-dlefilter]"):$(e)).data("dlefilter-id")||"dle-content",dleFilter.original[dleFilter.id]||"dle-content"==dleFilter.id||(dleFilter.original[dleFilter.id]=$("#"+dleFilter.id).html())}function e(){dleFilter.reset=!0;var e=$(this).closest("form"),t=$(e).data("dlefilter");d(this),0==dleFilter.ajaxUrl&&(document.title=dleFilter.title,history.pushState(null,dleFilter.title,dleFilter.path)),"none"!==filterNavigation&&"dle-content"==dleFilter.id&&1==dleFilter.navApart&&$(getNavigation(document.body)).replaceWith(navigation),dleFilter.path.indexOf("/"+dleFilter.filterUrl+"/")+1||"dle-content"==dleFilter.id?$("#dle-content").html(dleFilter.content):$("#"+dleFilter.id).html(dleFilter.original[dleFilter.id]),1==dleFilter.lazy&&($("[data-src]").lazyLoadXT(),$(".js-count-rating").wRateCount()),0<$("#dle-speedbar").length&&$("#dle-speedbar").html(dleFilter.speedbar),$(e).find('input[type="text"]').each(function(){let e=$(this).prop("name");if(0<e.length){if(e.indexOf("r.")+1){let e=$(this).data("ionRangeSlider");"single"==e.options.type?e.update({from:e.options.min}):"double"==e.options.type&&e.update({from:e.options.min,to:e.options.max})}else $(this).val("");void 0!==$(this).data("dlefilter-show")&&p(this)}}),$(e).find("select").each(function(e){0<$(this).prop("name").length&&($(this).children("option").each(function(){$(this).prop("selected",!1)}),1==dleFilter.jsSelect&&0<$(".tail-select").length&&tail.select('[data-dlefilter*="'+t+'"] select[data-select-id="'+e+'"]').reload(),void 0!==$(this).data("dlefilter-show")&&p(this))}),2==dleFilter.jsSelect&&0<$(".chosen-results").length&&$('[data-dlefilter*="'+t+'"] select').trigger("chosen:updated"),3==dleFilter.jsSelect&&$('[data-dlefilter*="'+t+'"] select').niceSelect("update"),$(e).find('input[type="radio"], input[type="checkbox"]').each(function(){0<$(this).prop("name").length&&($(this).prop("checked",!1),void 0!==$(this).data("dlefilter-show")&&p(this))}),dleFilter.reset=!1}function n(t){if("redirect"==(t=$.parseJSON(t)).content&&(dleFilter.ajax=1),1==dleFilter.ajax)window.location.href=t.url;else if(t.clean==dleFilter.defaultUrl)e();else{0<$("#dle-speedbar").length&&$("#dle-speedbar").html($("#dle-speedbar",t.speedbar).html());let e="";if(e=dleFilter.path.indexOf("/"+dleFilter.filterUrl+"/")+1?($("#dle-content").html(t.content),"#dle-content"):($("#"+dleFilter.id).html(t.content),"#"+dleFilter.id),t.player&&($(e+" .dleplyrplayer").length||$(e+" .dleplyrplayer").length||$(e+" .dlevideoplayer").length))if("plyr"==t.player){let t=Array.from(document.querySelectorAll(".dleplyrplayer:not(.dlepl)")).map(e=>new DLEPlayer(e));t.forEach(function(l,e){l.on("play",function(){t.forEach(function(e,t){l!=e&&e.pause()})})})}else $(".dleaudioplayer:not(.alreadyLoaded)").addClass("alreadyLoaded").cleanaudioplayer(),$(".dlevideoplayer:not(.alreadyLoaded)").addClass("alreadyLoaded").cleanvideoplayer();1===dleFilterId?($("pre").removeAttr("class"),$("pre").each(function(){$(this).find("code").length||$(this).wrapInner("<code>")}),hljs.highlightAll()):0===dleFilterId&&$("pre code:not([class])").each(function(e,t){hljs.highlightBlock(t,null)}),"none"!==navigation&&t.nav&&"dle-content"==dleFilter.id&&1==dleFilter.navApart?(filterNavigation=t.nav,navigation=getNavigation(document.body),$(navigation).replaceWith(t.nav)):t.nav||1!=dleFilter.navApart||(navigation=getNavigation(document.body),navigation.remove()),1==dleFilter.lazy&&$("[data-src]").lazyLoadXT(),0==dleFilter.ajaxUrl&&(history.pushState(null,t.title,t.clean),document.title=t.title)}}let r=function(i,a){if(!dleFilter.reset){$('[data-dlefilter*=dle-filter] input[name*="r."]').each(function(){var t=$(this).attr("name");if(void 0!==t&&0<t.length){t=$(this).data("ionRangeSlider");let e=0;"single"==t.options.type?e=t.options.min:"double"==t.options.type&&(e=t.options.min+";"+t.options.max),e==$(this).val()&&$(this).val("")}});let e,t,l="";if(!0===(a=a||!1))e=$(i).serialize();else{if(t=i.target.tagName.toUpperCase(),void 0!==i.target.type&&(l=i.target.type.toUpperCase()),"TEXTAREA"===t||"INPUT"===t&&("TEXT"===l||"RESET"===l))return;e=("FORM"!==t?$(this).closest("form"):$(this)).serialize()}d(t),$.ajax({beforeSend:function(){0==dleFilter.hideLoading&&ShowLoading("")},url:dle_root+"engine/lazydev/dle_filter/ajax.php",type:"POST",data:{data:e,url:dleFilter.path,dle_hash:dle_login_hash,dleFilterJSData:dleFilterJSData},success:function(e){e.error?DLEalert(e.text,dle_info):n(e)},error:function(e){n(e.responseText)}}).always(function(){0==dleFilter.hideLoading&&HideLoading("")})}};0<$("#dle-speedbar").length&&(dleFilter.speedbar=$("#dle-speedbar").html()),0<$("#dle-content").length&&(dleFilter.content=$("#dle-content").html()),$("body").on("click","[data-dlefilter=submit]",r),0==dleFilter.button&&$("body").on("change","[data-dlefilter*=dle-filter]",r),$("body").on("click","[data-dlefilter=reset]",e);function o(e){return e.valueOf()}function s(e){return e=e.toString().split(","),!!(Array.isArray(e)&&3===e.length&&(e[0]=parseInt(e[0]),e[1]=parseInt(e[1]),e[2]=parseInt(e[2]),0<e[0]&&0<e[1]&&e[1]<=12&&0<e[2]&&e[2]<=31))&&e}$("[data-dlefilter*=dle-filter]").find('input[type="text"][name*="r."]').each(function(){let i=$(this).data("slider-config");var t,a=$(this).data("slider-type"),d=$(this).data("slider-lang");let e=$(this).data("slider-mark"),n="";if(void 0!==i&&0<i.length){let l={};";"===i.slice(-1)&&(i=i.slice(0,-1)),i=i.split(";");for(let t=0;t<i.length;t++){let e=i[t].split(":");switch(e[0]=e[0].trim(),e[0]){case"АвтоПолзунок":l.slider=!0;break;case"Одиночный слайдер":l.type="single";break;case"Двойной слайдер":l.type="double";break;case"Минимальное значение":void 0!==e[1]&&($.isNumeric(e[1])?l.min=e[1]:"date"===a&&(n=s(e[1]),!1!==n&&(l.min=o(new Date(n[0],n[1]-1,n[2])))));break;case"Максимальное значение":void 0!==e[1]&&($.isNumeric(e[1])?l.max=e[1]:"date"===a&&(n=s(e[1]),!1!==n&&(l.max=o(new Date(n[0],n[1]-1,n[2])))));break;case"Начало слайдера":void 0!==e[1]&&($.isNumeric(e[1])?l.from=e[1]:"date"===a&&(n=s(e[1]),!1!==n&&(l.from=o(new Date(n[0],n[1]-1,n[2])))));break;case"Конец слайдера":void 0!==e[1]&&($.isNumeric(e[1])?l.to=e[1]:"date"===a&&(n=s(e[1]),!1!==n&&(l.to=o(new Date(n[0],n[1]-1,n[2])))));break;case"Шаг":void 0!==e[1]&&$.isNumeric(e[1])&&(l.step=e[1]);break;case"Шаблон":void 0!==e[1]&&""!==e[1]&&(l.skin=e[1]);break;case"Префикс":void 0!==e[1]&&""!==e[1]&&(l.prefix=e[1]);break;case"Постфикс":void 0!==e[1]&&""!==e[1]&&(l.postfix=e[1]);break;case"Сетка":l.grid=!0;break;case"Красивые числа":l.prettify_enabled=!0;break;case"Скрыть MinMax":l.hide_min_max=!0;break;case"Скрыть FromTo":l.hide_from_to=!0}}void 0===l.from&&(l.from=l.min),void 0===l.to&&(l.to=l.max),e&&(t=e.toString().split(","),l.onStart=function(e){!function(e,t,l){let i="";var a,d,n;for(let e=0;e<l.length;e++){var r=l[e].toString().split("|");a=parseInt(r[0]),d=t.min,n=t.max,i+='<span class="sliderShowcaseMark" style="left: '+((a-d)/(n-d)*100+"%")+'">'+r[1]+"</span>"}e.append(i)}(e.slider,l,t)}),"date"===a&&(l.prettify=function(e){let t=new Date(e);return t.toLocaleDateString(d,{year:"numeric",month:"long",day:"numeric"})}),l.prettify_enabled||"date"===a||(l.prettify_enabled=!1),l.slider&&(l.onFinish=function(e){r($('[name="'+e.input[0].name+'"]').closest("form"),!0)}),$(this).ionRangeSlider(l)}}),1==dleFilter.jsSelect&&$("[data-dlefilter*=dle-filter]").find("select").each(function(e){$(this).attr("data-select-id",e);let l=$(this).data("select-config"),i={};if(void 0!==l&&0<l.length){";"==l.slice(-1)&&(l=l.slice(0,-1)),l=l.split(";");for(let t=0;t<l.length;t++){let e=l[t].split(":");switch(e[0]){case"Поиск":i.search=!0;break;case"Скрыть выбранные":i.hideSelected=!0;break;case"Максимум выбрать":void 0!==e[1]&&$.isNumeric(e[1])&&(i.multiLimit=e[1]);break;case"Показать количество выбранных":i.multiContainer||(i.multiShowCount=!0);break;case"Вывод выбранных":i.multiContainer=!0,i.multiShowCount&&(i.multiShowCount=!1);break;case"Подсказка":void 0!==e[1]&&""!==e[1]&&(i.placeholder=e[1]);break;case"Язык":void 0!==e[1]&&""!=e[1].trim()||(e[1]="ru"),i.locale=e[1];break;case"Сортировать":void 0===e[1]||"ASC"!==e[1]&&"DESC"!==e[1]||(i.sortItems=e[1])}}}null==i.locale&&(i.locale="ru"),i.deselect=!0,tail.select('[data-dlefilter*=dle-filter] select[data-select-id="'+e+'"]',i).on("change",function(e,t){e=("OPTGROUP"===e.option.parentElement.tagName.toUpperCase()?e.option.parentElement:e.option).parentElement.name;"unselect"===t&&$('[name="'+e+'"]').val(""),0==dleFilter.button&&$('[name="'+e+'"]').trigger("change")})}),2==dleFilter.jsSelect&&$("[data-dlefilter*=dle-filter] select").chosen(),3==dleFilter.jsSelect&&$("[data-dlefilter*=dle-filter] select").niceSelect();function t(e,a){void 0!==e&&$.ajax({url:e,beforeSend:function(){0==dleFilter.hideLoading&&ShowLoading("")},success:function(t){if(0<$("#dle-speedbar").length&&$("#dle-speedbar").html($("#dle-speedbar",t).html()),"none"!==navigation&&1==dleFilter.navApart){let e=new DOMParser;var l=e.parseFromString(t,"text/html"),i=getNavigation(l),l=getNavigation(document.body);filterNavigation=i,$(l).replaceWith(i)}(window.location.href.toString().indexOf(a)+1?$("#dle-content"):$("#"+dleFilter.id)).html($("#dle-content",t).html()),1==dleFilter.lazy&&$("[data-src]").lazyLoadXT(),0==dleFilter.ajaxUrl&&(i=$(t).filter("title").text(),window.history.pushState(i,"",e),""!=i&&(document.title=$(t).filter("title").text())),0==dleFilter.ajaxAnim&&$("html, body").animate({scrollTop:$("#"+dleFilter.id).offset().top},400)},error:function(e){}}).always(function(){0==dleFilter.hideLoading&&HideLoading("")})}1==dleFilter.ajaxPage&&0!=urlFilter&&$("body").on("click",'a[href*="'+urlFilter+'"]',function(e){e.preventDefault(),dleFilter.id="dle-content";e=$(this).attr("href");return t(e,urlFilter),!1}),1==dleFilter.ajaxNav&&$("body").on("click",'a[href*="/'+dleFilter.filterUrl+'/"]',function(e){e.preventDefault(),d(this);e=$(this).attr("href");return t(e,"/"+dleFilter.filterUrl+"/"),!1}),Array.prototype.diff=function(t){return this.filter(function(e){return t.indexOf(e)<0})};let c={},f={},h={},p=function(l){var e=$(l).prop("tagName").toUpperCase(),i=$(l).prop("type").toUpperCase();let t=$(l).data("dlefilter-show"),a={};";"==t.slice(-1)&&(t=t.slice(0,-1)),t=t.split(";"),$.each(t,function(e,t){let l=t.split(":");l[0]&&l[1]&&(a[l[0]]=l[1].split(","))}),"SELECT"===e?$(l).find("option").each(function(e,l){$.each(a,function(e,t){0<$(l).val().toString().length&&$(l).prop("selected")&&0<=$.inArray($(l).val(),t)?1==dleFilter.jsSelect?c[e]=".dle-filter-select-"+e:c[e]='[data-dlefilter-hide="'+e+'"]':1==dleFilter.jsSelect?f[e]=".dle-filter-select-"+e:f[e]='[data-dlefilter-hide="'+e+'"]'})}):"INPUT"===e?$.each(a,function(e,t){"TEXT"===i?0<=$.inArray($(l).val(),t)?c[e]='[data-dlefilter-hide="'+e+'"]':f[e]='[data-dlefilter-hide="'+e+'"]':"RADIO"!==i&&"CHECKBOX"!==i||($(l).prop("checked")&&0<=$.inArray($(l).val(),t)?c[e]='[data-dlefilter-hide="'+e+'"]':f[e]='[data-dlefilter-hide="'+e+'"]')}):"TEXTAREA"===e&&$.each(a,function(e,t){0<=$.inArray($(l).val(),t)?c[e]='[data-dlefilter-hide="'+e+'"]':f[e]='[data-dlefilter-hide="'+e+'"]'}),h=Object.values(f).diff(Object.values(c)),h&&$.each(h,function(e,t){$(t).find('input[type="text"]').each(function(){let e=$(this).prop("name");if(void 0!==$(this).data("dlefilter-show")&&p(this),0<e.length)if(e.indexOf("r.")+1){let e=$(this).data("ionRangeSlider");e.update({from:e.options.min,to:e.options.max})}else $(this).val("")}),$(t).find("select").each(function(e){0<$(this).prop("name").length&&(void 0!==$(this).data("dlefilter-show")&&p(this),$(this).children("option").each(function(){$(this).attr("selected",!1)}),1==dleFilter.jsSelect&&0<$(".tail-select").length&&tail.select('[data-dlefilter*=dle-filter] select[data-select-id="'+e+'"]').reload())}),2==dleFilter.jsSelect&&0<$(".chosen-results").length&&$("[data-dlefilter*=dle-filter] select").trigger("chosen:updated"),3==dleFilter.jsSelect&&$("[data-dlefilter*=dle-filter] select").niceSelect("update"),$(t).find('input[type="radio"], input[type="checkbox"]').each(function(){0<$(this).prop("name").length&&(void 0!==$(this).data("dlefilter-show")&&p(this),$(this).attr("checked",!1))})})};dleFilter.path.indexOf("/"+dleFilter.filterUrl+"/")+1&&function(){let t=decodeURIComponent(location.href).split("/"+dleFilter.filterUrl+"/");if(t[1]){"/"===t[1].slice(-1)&&(t[1]=t[1].slice(0,-1)),t=t[1].split("/");let i=[];for(let e=0;e<t.length;e++)i[e]=t[e].split("="),i[e][1]&&(i[e][0]=i[e][0].replace(/\+/g," "),i[e][1]=i[e][1].replace(/\+/g," "));$('[data-dlefilter*=dle-filter] input[type="text"], [data-dlefilter*=dle-filter] textarea').each(function(){let e=$(this).attr("name");if(void 0!==e&&0<e.length)for(let t=0;t<i.length;t++)if(e===i[t][0])if(e.indexOf("r.")+1){let e=$(this).data("ionRangeSlider");var l=i[t][1].split(";");"single"==e.options.type?e.update({from:l[0]}):"double"==e.options.type&&e.update({from:l[0],to:l[1]})}else $(this).val(i[t][1])}),$("[data-dlefilter*=dle-filter] select").each(function(e){let t=$(this).attr("name");if(void 0!==t&&0<t.length){for(let e=0;e<i.length;e++)if(t===i[e][0]){let l=[];t.indexOf("c.")+1?l[0]=i[e][1]:l=i[e][1].split(","),$(this).find("option").each(function(e,t){0<=$.inArray(t.value,l)&&$(this).attr("selected",!0)})}1==dleFilter.jsSelect&&0<$(".tail-select").length&&tail.select('[data-dlefilter*=dle-filter] select[data-select-id="'+e+'"]').reload()}}),2==dleFilter.jsSelect&&0<$(".chosen-results").length&&$("[data-dlefilter*=dle-filter] select").trigger("chosen:updated"),3==dleFilter.jsSelect&&$("[data-dlefilter*=dle-filter] select").niceSelect("update"),$('[data-dlefilter*=dle-filter] input[type="radio"], [data-dlefilter*=dle-filter] input[type="checkbox"]').each(function(){var l,t=$(this).attr("name");if(void 0!==t&&0<t.length)for(let e=0;e<i.length;e++)t===i[e][0]&&(l=i[e][1].split(","),$(this).each(function(e,t){0<=$.inArray(t.value,l)&&$(this).attr("checked","checked")}))})}}(),$("[data-dlefilter-hide]").hide(),$("body").find("[data-dlefilter-show]").each(function(e,t){f={},h={},c={},p(t),h&&$(h.join(", ")).hide(),c&&$(Object.values(c).join(", ")).show()}),$("body").on("change","[data-dlefilter-show]",function(e){f={},h={},c={},$("body").find("[data-dlefilter-show]").each(function(e,t){p(t)}),h&&$(h.join(", ")).hide(),c&&$(Object.values(c).join(", ")).show()})});